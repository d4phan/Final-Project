<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Are Temperate Coastal Zones Entering a New Era of "Dry Heat"?</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/scrollama/3.2.0/scrollama.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Monaco', monospace;
            background: linear-gradient(to bottom, #1a1a2e 0%, #16213e 100%);
            color: #fff;
        }

        #header {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
        }

        h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1.5rem;
            color: #ccc;
            max-width: 800px;
        }

        #scrolly-section {
            position: relative;
            padding: 0;
        }

        #vis-container {
            position: sticky;
            top: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(to bottom, #16213e 0%, #0f3460 100%);
        }

        #visualization {
            width: 100%;
            height: 100%;
        }

        .step {
            height: 80vh;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            padding: 2rem;
        }

        .step-content {
            background: rgba(0, 0, 0, 0.7);
            padding: 2rem;
            border-radius: 10px;
            max-width: 400px;
            backdrop-filter: blur(10px);
        }

        .step-content h2 {
            color: #ffa500;
            margin-bottom: 1rem;
        }

        #footer {
            position: relative;
            min-height: 60vh;
            background: linear-gradient(to bottom, #0f3460 0%, #1a0000 100%);
            padding: 4rem 2rem;
            text-align: center;
            overflow: hidden;
        }

        #footer::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: linear-gradient(to top, #ff4500, transparent);
            animation: flicker 2s infinite alternate;
        }

        @keyframes flicker {
            0%, 100% { opacity: 0.8; }
            50% { opacity: 1; }
        }

        .flame {
            position: absolute;
            bottom: 0;
            width: 40px;
            height: 60px;
            background: radial-gradient(ellipse at center, #ff4500 0%, #ff6347 30%, transparent 70%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: burn 1.5s infinite ease-in-out;
        }

        @keyframes burn {
            0%, 100% { transform: translateY(0) scale(1); opacity: 0.8; }
            50% { transform: translateY(-20px) scale(1.1); opacity: 1; }
        }

        #footer-content {
            position: relative;
            z-index: 10;
        }

        #footer h2 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            color: #ff6b6b;
        }

        .projection-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin: 2rem 0;
            flex-wrap: wrap;
        }

        .stat {
            background: rgba(255, 69, 0, 0.2);
            padding: 1.5rem;
            border-radius: 10px;
            border: 2px solid #ff4500;
        }

        .stat-value {
            font-size: 3rem;
            font-weight: bold;
            color: #ff6347;
        }

        .stat-label {
            font-size: 1rem;
            color: #ccc;
            margin-top: 0.5rem;
        }

        .knob-indicator {
            position: absolute;
            top: 50%;
            right: 50px;
            transform: translateY(-50%);
            text-align: center;
        }

        .knob {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: radial-gradient(circle, #333, #111);
            border: 4px solid #666;
            position: relative;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        .knob-marker {
            position: absolute;
            top: 10px;
            left: 50%;
            width: 4px;
            height: 25px;
            background: #ff6b6b;
            transform-origin: bottom center;
            transition: transform 0.3s ease;
        }

        .knob-label {
            margin-top: 1rem;
            font-size: 0.9rem;
            color: #999;
        }
        #region-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 300px;
            height: 100vh;
            background: rgba(0,0,0,0.85);
            border-left: 3px solid #ff6b6b;
            padding: 2rem;
            color: white;
            backdrop-filter: blur(10px);
            transform: translateX(100%);   /* hidden off-screen */
            transition: transform 0.4s ease-out;
            z-index: 9999;
            box-shadow: -5px 0 20px rgba(0,0,0,0.4);
        }
        #region-panel.open {
            transform: translateX(0);      /* slide in */
        }

        #region-panel h3 {
            color: #ffa500;
            margin-bottom: 1rem;
        }

        #region-panel button {
            margin-top: 2rem;
            padding: 0.5rem 1rem;
            background: #ff6b6b;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="header">
        <h1>Are Temperate Coastal Zones Entering a New Era of "Dry Heat"?</h1>
        <p class="subtitle">An exploration of rising temperatures in coastal regions projected to 2050</p>
    </div>

    <div id="scrolly-section">
        <div id="vis-container">
            <svg id="visualization"></svg>
            <div class="knob-indicator">
                <div class="knob">
                    <div class="knob-marker"></div>
                </div>
                <div class="knob-label">Temperature</div>
            </div>
        </div>

        <div id="steps">
            <div class="step" data-step="0">
                <div class="step-content">
                    <h2>Present Day (2024)</h2>
                    <p>Coastal regions maintain moderate temperatures with seasonal variation. Our "crockpot" of coastal zones begins at baseline temperatures.</p>
                </div>
            </div>

            <div class="step" data-step="1">
                <div class="step-content">
                    <h2>2030 Projection</h2>
                    <p>The Pacific Coast begins to warm significantly, with average temperatures rising 1.2Â°C above baseline. The heat begins to build.</p>
                </div>
            </div>

            <div class="step" data-step="2">
                <div class="step-content">
                    <h2>2035 Projection</h2>
                    <p>Atlantic and Gulf Coast regions join the warming trend. Temperature increases accelerate to 2.1Â°C above baseline.</p>
                </div>
            </div>

            <div class="step" data-step="3">
                <div class="step-content">
                    <h2>2040 Projection</h2>
                    <p>Mediterranean-climate zones experience severe "dry heat" episodes. The crockpot is now simmering at 3.5Â°C above baseline.</p>
                </div>
            </div>

            <div class="step" data-step="4">
                <div class="step-content">
                    <h2>2050 Projection</h2>
                    <p>All temperate coastal zones reach critical warming thresholds. Average temperatures are 4.8Â°C above 2024 baselineâ€”our crockpot is boiling.</p>
                </div>
            </div>
        </div>
    </div>

    <div id="footer">
        <div id="footer-content">
            <h2>ðŸ”¥ By 2050: A Burning Reality ðŸ”¥</h2>
            <div class="projection-stats">
                <div class="stat">
                    <div class="stat-value">+4.8Â°C</div>
                    <div class="stat-label">Average Temperature Rise</div>
                </div>
                <div class="stat">
                    <div class="stat-value">85%</div>
                    <div class="stat-label">Coastal Zones Affected</div>
                </div>
                <div class="stat">
                    <div class="stat-value">42</div>
                    <div class="stat-label">Days Over 35Â°C</div>
                </div>
            </div>
            <p style="margin-top: 2rem; font-size: 1.2rem; max-width: 800px; margin-left: auto; margin-right: auto;">
                The data is clear: temperate coastal zones are transitioning into a new climate regime characterized by prolonged dry heat. Immediate action is needed to mitigate these projected increases.
            </p>
        </div>
    </div>
    <div id="region-panel"></div>

    <script>
        // Fake data for coastal regions
        const coastalRegions = [
            { name: "Pacific Coast", x: 200, y: 300, baseTemp: 18 },
            { name: "Atlantic Coast", x: 400, y: 280, baseTemp: 16 },
            { name: "Gulf Coast", x: 350, y: 350, baseTemp: 22 },
            { name: "Mediterranean", x: 500, y: 320, baseTemp: 19 }
        ];

        const projections = [
            { year: 2024, tempIncrease: 0, color: "#4a90e2" },
            { year: 2030, tempIncrease: 1.2, color: "#7fb3d5" },
            { year: 2035, tempIncrease: 2.1, color: "#f39c12" },
            { year: 2040, tempIncrease: 3.5, color: "#e67e22" },
            { year: 2050, tempIncrease: 4.8, color: "#e74c3c" }
        ];

        const svg = d3.select("#visualization");
        const width = window.innerWidth;
        const height = window.innerHeight;
        svg.attr("width", width).attr("height", height);

        // Create crockpot
        const potGroup = svg.append("g").attr("transform", `translate(${width/2}, ${height/2})`);

        // Pot body
        const pot = potGroup.append("ellipse")
            .attr("cx", 0)
            .attr("cy", 50)
            .attr("rx", 150)
            .attr("ry", 120)
            .attr("fill", "#333")
            .attr("stroke", "#666")
            .attr("stroke-width", 3);

        // Pot rim
        potGroup.append("ellipse")
            .attr("cx", 0)
            .attr("cy", -70)
            .attr("rx", 160)
            .attr("ry", 20)
            .attr("fill", "#444")
            .attr("stroke", "#666")
            .attr("stroke-width", 3);

        // Water/heat level
        const heatLevel = potGroup.append("ellipse")
            .attr("cx", 0)
            .attr("cy", 40)
            .attr("rx", 140)
            .attr("ry", 100)
            .attr("fill", "#4a90e2")
            .attr("opacity", 0.6);

        // Bubbles
        const bubblesGroup = potGroup.append("g");

        // Region labels feeding into pot
        const regionsGroup = svg.append("g");
        
        coastalRegions.forEach((region, i) => {
            const angle = (i * Math.PI / 2) - Math.PI / 4;
            const distance = 250;
            const x = width/2 + Math.cos(angle) * distance;
            const y = height/2 + Math.sin(angle) * distance;

            // Arrow to pot
            regionsGroup.append("line")
                .attr("x1", x)
                .attr("y1", y)
                .attr("x2", width/2 + Math.cos(angle) * 160)
                .attr("y2", height/2 + Math.sin(angle) * 80)
                .attr("stroke", "#666")
                .attr("stroke-width", 2)
                .attr("stroke-dasharray", "5,5")
                .attr("opacity", 0.5);

            // Region label
            const label = regionsGroup.append("text")
                .attr("x", x)
                .attr("y", y)
                .attr("text-anchor", "middle")
                .attr("fill", "#fff")
                .attr("font-size", "14px")
                .style("cursor", "pointer")
                .text(region.name)
                .on("click", () => {
                    showRegionPanel(region);
                });
                
                
        });

        // Temperature label
        const tempLabel = potGroup.append("text")
            .attr("x", 0)
            .attr("y", -100)
            .attr("text-anchor", "middle")
            .attr("fill", "#fff")
            .attr("font-size", "24px")
            .attr("font-weight", "bold");

            let bubbleInterval = null;

        function updateVisualization(step) {
            const projection = projections[step];
            const temp = projection.tempIncrease;
            
            // Update heat level color
            heatLevel
                .transition()
                .duration(800)
                .attr("fill", projection.color);

            // Update temperature label
            tempLabel.text(`+${temp.toFixed(1)}Â°C`);

            // Create bubbles based on temperature
            // const numBubbles = Math.floor(temp * 5);
            
            // bubblesGroup.selectAll("circle").remove();
            
            // for (let i = 0; i < numBubbles; i++) {
            //     bubblesGroup.append("circle")
            //         .attr("cx", (Math.random() - 0.5) * 200)
            //         .attr("cy", 80)
            //         .attr("r", 3 + Math.random() * 5)
            //         .attr("fill", "white")
            //         .attr("opacity", 0.7)
            //         .transition()
            //         .duration(1000 + Math.random() * 1000)
            //         .attr("cy", -50)
            //         .attr("opacity", 0)
            //         .remove();
            // }

                            // Stop previous bubbling
            if (bubbleInterval) {
                clearInterval(bubbleInterval);
                bubbleInterval = null;
            }


            if (step === 1) {
                bubbleInterval = setInterval(() => {
                    for (let i = 0; i < 5; i++) { // increase this number for more
                        createBubble();
                    }
                }, 700); // decrease this for faster bubbling
            } else {
                // Single bubbling for earlier steps
                const numBubbles = Math.floor(temp * 5);
                for (let i = 0; i < numBubbles; i++) {
                    createBubble();
                }
            }

            if (step === 2) {
                bubbleInterval = setInterval(() => {
                    for (let i = 0; i < 10; i++) { // increase this number for more
                        createBubble();
                    }
                }, 300); // decrease this for faster bubbling
            } else {
                // Single bubbling for earlier steps
                const numBubbles = Math.floor(temp * 5);
                for (let i = 0; i < numBubbles; i++) {
                    createBubble();
                }
            }

            if (step === 3) {
                bubbleInterval = setInterval(() => {
                    for (let i = 0; i < 15; i++) { // increase this number for more
                        createBubble();
                    }
                }, 100); // decrease this for faster bubbling
            } else {
                // Single bubbling for earlier steps
                const numBubbles = Math.floor(temp * 5);
                for (let i = 0; i < numBubbles; i++) {
                    createBubble();
                }
            }

            // Continuous bubbling for 2050
            if (step === 4) {
                bubbleInterval = setInterval(() => {
                    for (let i = 0; i < 20; i++) { // increase this number for more
                        createBubble();
                    }
                }, 25); // decrease this for faster bubbling
            } else {
                // Single bubbling for earlier steps
                const numBubbles = Math.floor(temp * 5);
                for (let i = 0; i < numBubbles; i++) {
                    createBubble();
                }
            }


            // Update knob
            const knobRotation = (step / 4) * 180;
            d3.select(".knob-marker")
                .style("transform", `translateX(-50%) rotate(${knobRotation}deg)`);
        }

        function createBubble() {
    bubblesGroup.append("circle")
        .attr("cx", (Math.random() - 0.5) * 200)
        .attr("cy", 80)
        .attr("r", 3 + Math.random() * 5)
        .attr("fill", "white")
        .attr("opacity", 0.7)
        .transition()
        .duration(1000 + Math.random() * 1000)
        .attr("cy", -50)
        .attr("opacity", 0)
        .remove();
}

//         function showRegionPanel(region) {
//     const panel = document.getElementById("region-panel");

//     panel.innerHTML = `
//         <div class="panel-content">
//             <h3>${region.name}</h3>
//             <p><strong>Base Temp:</strong> ${region.baseTemp}Â°C</p>
//             <p><strong>Projected Increase by 2050:</strong> +4.8Â°C</p>
//             <button id="close-panel">Close</button>
//         </div>
//     `;

//     panel.style.display = "block";

//     document.getElementById("close-panel").onclick = () => {
//         panel.style.display = "none";
//     };
// }

function showRegionPanel(region) {
    const panel = document.getElementById("region-panel");

    panel.innerHTML = `
        <div class="panel-content">
            <h3>${region.name}</h3>
            <p><strong>Base Temp:</strong> ${region.baseTemp}Â°C</p>
            <p><strong>Projected Increase by 2050:</strong> +4.8Â°C</p>
            <button id="close-panel">Close</button>
        </div>
    `;

    panel.classList.add("open");

    document.getElementById("close-panel").onclick = () => {
        panel.classList.remove("open");
    };
}

document.addEventListener("click", e => {
    const panel = document.getElementById("region-panel");
    if (!panel.contains(e.target) && !e.target.matches("text")) {
        panel.classList.remove("open");
    }
});

        // Scrollama setup
        const scroller = scrollama();

        scroller
            .setup({
                step: ".step",
                offset: 0.5,
                debug: false
            })
            .onStepEnter(response => {
                const step = +response.element.dataset.step;
                updateVisualization(step);
            });

        // Initialize
        updateVisualization(0);

        // Generate flames in footer
        const footer = document.getElementById('footer');
        for (let i = 0; i < 20; i++) {
            const flame = document.createElement('div');
            flame.className = 'flame';
            flame.style.left = `${Math.random() * 100}%`;
            flame.style.animationDelay = `${Math.random() * 1.5}s`;
            flame.style.animationDuration = `${1 + Math.random()}s`;
            footer.appendChild(flame);
        }

        // Resize handler
        window.addEventListener('resize', () => {
            scroller.resize();
        });
    </script>
</body>
</html>
